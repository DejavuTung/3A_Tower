# 预测性瞄准系统测试指南

## 测试目标
验证预测性瞄准系统是否能正确计算弓箭命中移动敌人的可能性，避免无效攻击。

## 测试环境准备

### 1. 打开游戏场景
- 在Unity中打开`SampleScene.unity`
- 确保所有脚本已编译通过

### 2. 设置测试参数
- 确保`AutoTowerDefenseDemo`组件中的参数设置正确：
  - `towerRange`: 1.8f
  - `towerCooldown`: 0.5f
  - `enemySpeed`: 0.5f

## 测试用例

### 测试用例1: 正常移动敌人命中测试
**目标**: 验证系统能正确预测并命中正常移动的敌人

**步骤**:
1. 开始游戏
2. 观察第一波敌人进入攻击范围
3. 检查控制台输出，确认出现"预测性瞄准成功"信息
4. 观察弓箭是否准确命中移动的敌人

**预期结果**:
- 控制台显示预测性瞄准成功信息
- 弓箭准确命中移动的敌人
- 敌人受到伤害并可能死亡

### 测试用例2: 停顿时敌人测试
**目标**: 验证系统能正确处理停顿时敌人

**步骤**:
1. 开始游戏
2. 等待敌人被弓箭击中进入停顿状态
3. 观察系统是否直接瞄准敌人当前位置
4. 检查控制台是否显示"敌人停顿时直接瞄准当前位置"

**预期结果**:
- 停顿时敌人被直接瞄准当前位置
- 弓箭准确命中停顿时敌人
- 控制台显示相应的调试信息

### 测试用例3: 高速移动敌人跳过测试
**目标**: 验证系统能正确跳过无法命中的高速移动敌人

**步骤**:
1. 开始游戏
2. 观察是否有敌人被系统跳过攻击
3. 检查控制台是否显示"敌人移动速度过快，弓箭无法命中"
4. 验证被跳过的敌人确实无法被弓箭命中

**预期结果**:
- 高速移动敌人被系统跳过
- 控制台显示速度过快的警告信息
- 被跳过的敌人确实无法被弓箭命中

### 测试用例4: 攻击范围边界测试
**目标**: 验证系统能正确处理攻击范围边缘的敌人

**步骤**:
1. 开始游戏
2. 观察敌人接近攻击范围边缘时的处理
3. 检查控制台是否显示"预测目标位置超出攻击范围"
4. 验证边缘敌人是否被正确跳过

**预期结果**:
- 攻击范围边缘的敌人被正确跳过
- 控制台显示超出范围的警告信息
- 避免无效攻击

### 测试用例5: 游戏速度影响测试
**目标**: 验证不同游戏速度下预测算法的准确性

**步骤**:
1. 开始游戏
2. 分别测试0.5X、1X、2X、4X游戏速度
3. 观察每种速度下的预测准确性
4. 检查弓箭飞行时间是否正确调整

**预期结果**:
- 不同游戏速度下预测算法都能正常工作
- 弓箭飞行时间根据游戏速度正确调整
- 命中率在不同速度下保持一致

### 测试用例6: 精度误差测试
**目标**: 验证系统能正确处理移动造成的命中误差

**步骤**:
1. 开始游戏
2. 观察敌人快速移动时的处理
3. 检查控制台是否显示"敌人移动造成的误差过大"
4. 验证误差过大的敌人是否被跳过

**预期结果**:
- 移动误差过大的敌人被跳过
- 控制台显示误差过大的警告信息
- 系统避免低精度攻击

## 调试信息检查

### 关键调试信息
在测试过程中，注意观察控制台输出的以下信息：

1. **预测性瞄准成功**:
   ```
   预测性瞄准成功 - 敌人当前位置: (x,y,z), 预测位置: (x,y,z), 移动距离: 0.xxx
   ```

2. **敌人停顿时瞄准**:
   ```
   敌人停顿时直接瞄准当前位置
   ```

3. **速度过快警告**:
   ```
   敌人移动速度过快，弓箭无法命中: 相对速度 x.xxx > 弓箭速度的80% x.xxx
   ```

4. **超出范围警告**:
   ```
   预测目标位置超出攻击范围: x.xxx > x.xxx
   ```

5. **误差过大警告**:
   ```
   敌人移动造成的误差过大: x.xxx > x.xxx
   ```

### 调试信息分析
- **成功信息**: 表示预测算法工作正常
- **警告信息**: 表示系统正确识别并跳过了无法命中的目标
- **错误信息**: 表示系统存在问题，需要进一步调试

## 性能测试

### 测试目标
验证预测性瞄准系统不会显著影响游戏性能

**步骤**:
1. 开始游戏并运行多个波次
2. 观察帧率是否保持稳定
3. 检查内存使用是否正常
4. 验证系统响应是否及时

**预期结果**:
- 帧率保持稳定（60FPS左右）
- 内存使用正常增长
- 系统响应及时，无明显延迟

## 问题排查

### 常见问题及解决方案

1. **预测性瞄准总是失败**
   - 检查`EnemyMovement.GetCurrentVelocity()`方法是否正确实现
   - 验证敌人速度计算是否准确

2. **弓箭总是错过目标**
   - 检查预测位置计算是否正确
   - 验证弓箭飞行时间设置是否合理

3. **系统性能下降**
   - 检查预测计算是否过于频繁
   - 考虑添加缓存机制

4. **调试信息不显示**
   - 确保Debug.Log没有被禁用
   - 检查控制台窗口是否打开

## 测试报告模板

### 测试结果记录
```
测试用例: [用例名称]
测试时间: [时间]
测试结果: [通过/失败]
问题描述: [如有问题，详细描述]
控制台输出: [关键调试信息]
```

### 总体评估
- 预测性瞄准成功率: [百分比]
- 系统性能影响: [轻微/中等/严重]
- 游戏体验改善: [明显/一般/不明显]
- 建议优化: [具体建议] 